$(document).ready(function(){function e(){r();var e=$(".edit-icon-cancel");e.parent().css({"background-color":"#fff","z-index":"0",position:"initial"}),$(".edit-icon-cancel").parent().find("input").css("width","100%"),e.siblings(".edit-icon-approved").remove(),e.remove(),$("div.editing-mask").remove()}function a(e,a){"real_name"==a?e.val(c):"id_card_code"==a?e.val(s):"date_of_birth"==a&&e.val(p)}function i(e,a){"real_name"==e?c=a:"id_card_code"==e?s=a:"date_of_birth"==e&&(p=a)}function n(e){e.removeAttr("readonly",""),e.parent().css({"background-color":"#f8f8f8","z-index":"999",position:"relative"}),e.css("width","92%")}function t(e,a){1==a&&(e.parent().append('<a class="edit-icon-common edit-icon-approved"></a>'),e.parent().append('<a class="edit-icon-common edit-icon-cancel"></a>'),$("body").append('<div class="editing-mask"></div>'))}function r(){l=0}function o(e,a){var i=!1,n=new RegExp("^[A-Za-zs]{1,}[. ]{0,1}[A-Za-zs]{0,}$"),t=new RegExp("[A-Za-z0-9]"),r=new RegExp("[0-9]{4}-[0-9]{2}-[0-9]{2}");return"real_name"==e?i=n.test(a):"id_card_code"==e?i=t.test(a):"date_of_birth"==e&&(i=r.test(a)),i}function d(e){e.value=e.value.replace(/(^|\W)(?=\d\W)/g,"$10").replace(u,v).replace(/(\W)+/g,"$1")}var c=$("#real_name").val(),s=$("#id_card_code").val(),p=$("#date_of_birth").val();$(".dashboard_setup .dashboard_upload_image").hover(function(){$(this).find(".dashboard_mask").toggle()}),$(".dashboard_mask").find("a").click(function(){$(this).siblings("input").trigger("click")}),$(".dashboard_mask").find("input[type=file]").change(function(e){$(this).parent().siblings("img").attr("src",URL.createObjectURL(e.target.files[0]))});var l=0;$(".dashboard_info input").on("click",function(){var r=$(this);l++,n(r),t(r,l),$(".edit-icon-cancel").bind("click",function(){$("#popup-error-info").remove(),e(),a(r,r.attr("id"))}),$(".edit-icon-approved").bind("click",function(){1==o(r.attr("id"),r.val())?($("#popup-error-info").remove(),e(),inputValueChange(r.attr("id"),r.val()),i(r.attr("id"),r.val())):$(this).parent().parent().after('<div id="popup-error-info">输入的格式有误！</div>')})});var f="yyyy-mm-dd",u=new RegExp(f.replace(/(\w+)\W(\w+)\W(\w+)/,"^\\s*($1)\\W*($2)?\\W*($3)?([0-9]*).*").replace(/m|d|y/g,"\\d")),v="$1/$2/$3$4".replace(/\//g,f.match(/\W/));$("#date_of_birth").keyup(function(e){e.ctrlKey||e.metaKey||!(32==e.keyCode||e.keyCode>46)||d(e.target)}),$("#password-update-submit").submit(function(e){var a=$("#id_password").val(),i=$("#id_password_confirm").val();a!=i&&(e.preventDefault(),$(".error_mes").html("您两次输入的密码不一致"))})});