$.cookie("mx_token","",{expires:-1}),$.cookie("mx_secret","",{expires:-1}),$(document).ready(function(){$(".registration-form .div-group:first").fadeIn("slow"),$('.registration-form input[type="text"], .registration-form input[type="password"], .registration-form textarea').on("focus",function(){$(this).removeClass("input-error")});var e=!0;$("#get_verify").click(function(){var n=$(this);$(this).prop("disabled",!0);var r=$("#id_telephone").val(),a=$("#countries_phone").val(),i=null,t=60;return i=setInterval(function(){$("#get_verify").html(t+"秒后重发"),t--,0==t&&(clearInterval(i),n.prop("disabled",!1),n.html("重新发送"),t=60)},1e3),("China"!=a&&r.length>6||"China"==a&&r.length>=15)&&$.ajax({type:"post",url:baseUrl+"/verify_code/send",data:{phone:r},dataType:"json",success:function(n){1==n&&(e=!0),0==n&&alert("验证码获取失败")}}),!1});var n={};$("#id_referral_code").on("blur",function(){var e=$.trim($("#id_referral_code").val());return n.referral_code=e,""!=e&&$.ajax({type:"get",url:baseUrl+"/referral_code/verify",data:n,success:function(e){return 1==e.body.code&&($(".page1-error-div").html("<div class='alert alert-warning' style='text-align:center; height: 45px; margin-top: -18px; background-color: #fff; border: none; font-size: 12px; color: orangered'>邀请码有效  注册成功后礼品卡将发送至您的邮箱!</div>"),$(".page2-error-div").html("<div class='alert alert-warning' style='text-align: center; font-size: 12px; color: orangered'>邀请码有效  注册成功后礼品卡将发送至您的邮箱!</div>")),2==e.body.code||3==e.body.code?($(".page1-error-div").html("<div class='alert alert-warning' style='text-align: center; height: 45px; margin-top: -18px; background-color: #fff; border: none; font-size: 12px; color: orangered'>亲爱的用户，邀请码失效,活动礼品已全部派完，感谢您对美信金融的关注!</div>"),$(".page2-error-div").html("<div class='alert alert-warning' style='text-align: center; font-size: 12px; color: orangered'>亲爱的用户，邀请码失效,活动礼品已全部派完，感谢您对美信金融的关注!</div>"),!1):4==e.body.code?($(".page1-error-div").html("<div class='alert alert-warning' style='text-align: center; height: 45px; margin-top: -18px; background-color: #fff; border: none; font-size: 12px; color: orangered'>亲爱的用户,您的验证码错误,请核对后填写!</div>"),$(".page2-error-div").html("<div class='alert alert-warning' style='text-align: center; font-size: 12px; color: orangered'>亲爱的用户,您的验证码错误,请核对后填写!</div>"),!1):void 0}}),!1}),$("#id_referral_code").on("focus",function(){$(".alert").remove()}),$(".registration-form #first-page-next-btn").on("click",function(){var e=$(this).parents(".div-group"),r=!0;e.find('input[name="phone"]'),e.find('input[name="verifyCode"]'),e.find('input[type="password"]'),e.find('input[name="email"]');if(e.find(".input-error").removeClass("input-error"),e.find('input[name="phone"], input[name="verifyCode"], input[type="password"], input[name="email"]').each(function(){if("China"==$("#countries_phone").val()&&$('input[name="phone"]').val().length<15)return $(this).addClass("input-error"),r=!1,!1;if($('input[name="verifyCode"]').val().length<6)return $("#id_verify").addClass("input-error"),r=!1,!1;if(""==$("#id_password").val())return $("#id_password").addClass("input-error"),r=!1,!1;var e=$("#id_email").val();return e.indexOf("@")==-1?($("#id_email").addClass("input-error"),r=!1,!1):e.indexOf(".")==-1?($("#id_email").addClass("input-error"),r=!1,!1):void $(this).removeClass("input-error")}),r){e.fadeOut(400,function(){$("#page1").next().fadeIn()});var a=$.trim($("#id_email").val());n.email=a,n.password=$("#id_password").val(),n.phone=$.trim($("#id_telephone").val()),n.country=$("#countries_phone").val(),n.verify_code=$("#id_verify").val(),n.referral_code=$("#id_referral_code").val()}}),$(".registration-form .btn-previous").on("click",function(){$(this).parents("#page2").fadeOut(400,function(){$(this).prev().fadeIn()})}),$(".registration-form #investor-type-next-btn").on("click",function(){var e=$(this).parents("#page2"),r=!0,a=$("input[name=is_international_investor]:checked").val();e.find('input[name="is_international_investor"]').each(function(){$('input[name="is_international_investor"]').is(":checked")?$(this).removeClass("input-error"):($(this).addClass("input-error"),r=!1,$(".page2-error-div").html("<div class='alert alert-warning'>请选择您的投资者类型</div>"))}),r&&(n.is_international_investor=$("#page2 .form-group").find("input[type='radio']:checked").val(),"True"==a?e.fadeOut(400,function(){$("#international_page3").fadeIn()}):e.fadeOut(400,function(){$("#american_page3").fadeIn()}))}),$(".registration-form .btn-previous").on("click",function(){$(this).parents(".page3").fadeOut(400,function(){$("#page2").fadeIn()})}),$("#american-next-btn").click(function(){var e=$(this).parents("#american_page3"),r=!0,a=$("input[name=questionaire_answer]:checked").val();console.log(a),e.find('input[name="questionaire_answer"]').each(function(){$('input[name="questionaire_answer"]').is(":checked")?$(this).removeClass("input-error"):($(this).addClass("input-error"),r=!1,$(".page3-error-div").html("<div class='alert alert-warning'>请选择您的投资者条件</div>"))}),$('input[name="american-agree"]').is(":checked")?$(".page3-error-div").html(""):($(".page3-error-div").html("<div class='alert alert-warning'>请同意网站的使用条款和隐私协议</div>"),r=!1),r&&(n.questionaire_answer=$(".form-group").find("input[type='radio']:checked").val(),e.fadeOut(400,function(){$("#page4").fadeIn()}))}),$("#international-next-btn").on("click",function(){var e=$(this).parents("#international_page3"),n=!0;$('input[name="international-agree"]').is(":checked")?$("#international-page3-error-div").html(""):($("#international-page3-error-div").html("<div class='alert alert-warning'>请同意网站的使用条款和隐私协议</div>"),n=!1),n&&e.fadeOut(400,function(){$("#page4").fadeIn()})}),$("#fourth-page-prev-btn").on("click",function(){var e=$(this).closest("#page4");is_international_investor=$("#page2 .form-group").find("input[type='radio']:checked").val(),"True"==is_international_investor?e.fadeOut(400,function(){$("#international_page3").fadeIn()}):e.fadeOut(400,function(){$("#american_page3").fadeIn()})}),$("#fourth-page-next-btn").on("click",function(){var e=$(this).closest("#page4"),r=!0,a=e.find('input[name="bankname"]'),i=e.find('input[name="bankadd"]'),t=e.find('input[type="bankaccountnum"]'),o=e.find('input[name="bankaccountname"]'),d=e.find('input[name="bankSwiftCode"]'),l=e.find('input[name="ABA_Number"]');e.find('input[name="bankname"], input[name="bankadd"], input[type="bankaccountnum"], input[name="bankaccountname"], input[name="bankSwiftCode"], input[name="ABA_Number"]').each(function(){if(""==$.trim($("#id_bankname").val()))return $("#id_bankname").addClass("input-error"),r=!1,!1;if(""==$.trim($("#id_bankadd").val()))return $("#id_bankadd").addClass("input-error"),r=!1,!1;if(0==$.trim($("#id_bankaccountnum").val().length))return $("#id_bankaccountnum").addClass("input-error"),r=!1,!1;if($("#id_bankaccountnum").removeClass("input-error"),""==$.trim($("#id_bankaccountname").val()))return $("#id_bankaccountname").addClass("input-error"),r=!1,!1;if(""==$.trim($("#id_ABA_Number").val())&&""==$.trim($("#id_bankSwiftCode").val())){if(""==$.trim($("#id_bankSwiftCode").val()))return $("#id_bankSwiftCode").addClass("input-error"),r=!1,!1;if(""==$.trim($("#id_ABA_Number").val()))return $("#id_ABA_Number").addClass("input-error"),r=!1,!1}return""!=$.trim($("#id_ABA_Number").val())||""!=$.trim($("#id_bankSwiftCode").val())?(r=!0,$("#id_ABA_Number").removeClass("input-error"),$("#id_bankSwiftCode").removeClass("input-error"),!1):void 0}),r&&(e.fadeOut(400,function(){$("#page5").fadeIn()}),n.bankname=$.trim(a),n.bankadd=$.trim(i),n.bankaccountnum=$.trim(t),n.bankaccountname=$.trim(o),n.bankSwiftCode=$.trim(d),n.ABA_Number=$.trim(l),e.fadeOut(400,function(){$("#page5").fadeIn()}))})});