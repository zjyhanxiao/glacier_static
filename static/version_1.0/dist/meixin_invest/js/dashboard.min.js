$(document).ready(function(){function t(t){t.value=t.value.replace(/(^|\W)(?=\d\W)/g,"$10").replace(x,D).replace(/(\W)+/g,"$1")}function a(){window.location="/login"}function e(t){$(".navbar ul li:last-child").html('<a class="btn btn-min-width" href="/investor/dashboard">我的账户</a>'),$(".navbar ul li:nth-last-child(2)").html('<a class="btn btn-min-width-sm logout" href="javascript:;">退出</a>'),$(".ajax_wait p,.ajax_wait").hide();var a={fields:"investor_type,real_name,mailing_address_country,mailing_address_region,mailing_address_city,mailing_address_street,mailing_address_door,mailing_address_apartment,phone,email,id_card_code,id_card_photo,passport_code,passport_photo"};a=$.extend({},a,cookie_tooken),Ajax_Data({url:baseUrl+"/profile/get",data:a,fn:o}),Ajax_Data({url:baseUrl+"/order/summary",data:cookie_tooken,fn:l}),$(".get_appointment").on("click",function(){Ajax_Data({url:baseUrl+"/appointment/listByUser",data:cookie_tooken,fn:n})}),$(".uncommit").on("click",function(){Ajax_Data({url:baseUrl+"/order/list/uncommit",data:cookie_tooken,fn:r})}),$(".closefund").on("click",function(){Ajax_Data({url:baseUrl+"/order/list/closefund",data:cookie_tooken,fn:d})}),$(".history").on("click",function(){Ajax_Data({url:baseUrl+"/order/list/history",data:cookie_tooken,fn:i})}),$(".flexible").on("click",function(){Ajax_Data({url:baseUrl+"/order/list/openfund",data:cookie_tooken,fn:s})}),$("#change_btn").on("click",function(){$("#id_real_name,#id_investor_type,#id_card,#passport_code,#id_birth_date").prop("disabled",!1).removeAttr("style"),$(".dashboard_id_image").append('<div class="dashboard_mask" style="display:none"><a>选择图片</a> <input id="id_identification_card_photo" name="identification_card_photo" type="file"></div>'),$(".dashboard_passport_image").append('<div class="dashboard_mask" style="display:none"><a>选择图片</a> <input id="id_passport_photo" name="passport_photo" type="file"></div>')}),$(".dashboard_upload_image").hover(function(){$(this).find(".dashboard_mask").toggle()}),$("body").on("click",".dashboard_mask a",function(){$(this).siblings("input").trigger("click")}),$(".dashboard_upload_image").on("change","input[type=file]",function(t){var a=$(this),e=a.val().toLowerCase(),o=new RegExp("(.*?).(jpg|jpeg|png|gif|bmp)$");o.test(e)?(w(a),a.parent().siblings("img").attr("src",URL.createObjectURL(t.target.files[0]))):(a.val(""),alert("图片格式不正确，支持图片格式(.jpg|.jpeg|.png|.gif|.bmp)"))}),order_number=getUrlParam("order_number");var e=$(".dashboard_id_image").find("img").attr("src"),_=$(".dashboard_passport_image").find("img").attr("src");$("#save_submit").on("click",function(){function t(t){alert("更新资料成功"),$("#id_real_name,#id_card,#passport_code,#id_birth_date").prop("disabled",!0).attr("style","border: none;background: none;box-shadow: none;"),$("#id_investor_type").prop("disabled",!0),$(".dashboard_id_image,.dashboard_passport_image").remove(".dashboard_mask"),o.prop("disabled",!1)}function a(t){alert(t),o.prop("disabled",!1)}console.log(default_id_card_photo),console.log(default_passport_photo),console.log(id_card_photo),console.log(passport_photo);var o=$(this);o.prop("disabled",!0);var l={};l.real_name=$("#id_real_name").val(),l.investor_type=$("#id_investor_type").val(),l.id_card_code=$("#id_card").val(),l.passport_code=$("#passport_code").val(),l.date_of_birth=$("#id_birth_date").val(),default_id_card_photo?l.id_card_photo=e:l.id_card_photo=id_card_photo,default_passport_photo?l.passport_photo=_:l.passport_photo=passport_photo,l=$.extend({},l,cookie_tooken),console.log(l),Ajax_Data({type:"post",url:baseUrl+"/profile/update",data:l,fn:t,fail_fn:a})}),$("#pwd_reset").on("click",function(){var t=$(this);return t.prop("disabled",!0),$(".pws_reset").find("span").remove(),p(t),!1}),$(".pws_reset input").change(function(){$("#pwd_reset").prop("disabled",!1)})}function o(t){if(t){investor_type=t.investor_type,A=t.real_name;var a="US";""!=t.mailing_address_country&&null!=t.mailing_address_country&&(a=t.mailing_address_country),U=a+" "+t.mailing_address_region+" "+t.mailing_address_city+" "+t.mailing_address_street+" "+t.mailing_address_door+" "+t.mailing_address_apartment,""!=t.real_name&&null!=t.real_name&&$("#id_real_name").val(t.real_name),""!=t.investor_type&&null!=t.investor_type&&$("#id_investor_type").val(investor_type),""!=t.phone&&null!=t.phone&&$("#id_phone").val(t.phone),""!=t.email&&null!=t.email&&$("#id_email").val(t.email),""!=t.id_card_code&&null!=t.id_card_code&&$("#id_card").val(t.id_card_code),""!=t.passport_code&&null!=t.passport_code&&$("#passport_code").val(t.passport_code),""!=t.date_of_birth&&null!=t.date_of_birth&&$("#id_birth_date").val(t.date_of_birth),""!=t.id_card_photo&&null!=t.id_card_photo&&($(".dashboard_id_image img").attr("src",t.id_card_photo),default_id_card_photo=!1),""!=t.passport_photo&&null!=t.passport_photo&&($(".dashboard_passport_image img").attr("src",t.passport_photo),default_passport_photo=!1)}}function l(t){if(t){var a='<div class="col-lg-4">已投项目<p>invested_product_value</p></div><div class="col-lg-4">投资总额($)<p>invested_total_value</p></div><div class="col-lg-4">投资收益($)<p>invested_value</p></div>';a=a.replace("invested_product_value",t.count),a=a.replace("invested_total_value",t.invest_amount),a=a.replace("invested_value",t.income_amount),$(".my_index").html(a)}}function n(t){var a="";return t.length<1?($(".book_order").html("暂无预约记录"),!1):void(t&&t.length>=1&&($.each(t,function(e){var o=t[e].minimum_invest_amount;o=o>=1e4?o/1e4+"万美元":"$"+o;var l=t[e].interested_amount;l="$"+l,a+='<div class="order_list"><h4>'+t[e].product_name+" "+t[e].product_number+'</h4><ul class="invest_table clearfix"><li>预计年化收益：'+t[e].return_rate+"%</li><li>投资期限："+t[e].invest_term+"个月</li><li>起投金额："+o+"</li><li>感兴趣金额："+l+"</li><li>预约时间："+t[e].appointment_date+'</li><li><button class="status_btn">'+t[e].diaplay_status+"</button></li></ul></div>"}),$(".book_order").html(a)))}function r(t){var a="";return t.length<1?($(".not_order").html("暂无未完成订单"),!1):void(t&&t.length>=1&&($.each(t,function(e){var o="";"OFF_SHORE"==t[e].product_location&&"NON_CROWD_FUNDING"==t[e].product_type&&"CLOSED"==t[e].operation_mode&&(o="/fa_invest/invest_yellowstone_step_1.html?order_number="+t[e].order_number+"&product_id="+t[e].product_id),"ON_SHORE"==t[e].product_location&&"CROWD_FUNDING"==t[e].product_type&&1==investor_type&&(o="/fa_invest/international/form_step_1.html?order_number="+t[e].order_number+"&product_id="+t[e].product_id),"ON_SHORE"==t[e].product_location&&"CROWD_FUNDING"==t[e].product_type&&2==investor_type&&(o="/fa_invest/american/form_usa_step_1.html?order_number="+t[e].order_number+"&product_id="+t[e].product_id),"ON_SHORE"==t[e].product_location&&"NON_CROWD_FUNDING"==t[e].product_type&&"OPEN"==t[e].operation_mode&&(o="/fa_invest/invest_yellowstone_step_1.html?order_number="+t[e].order_number+"&product_id="+t[e].product_id);var l=t[e].minimum_invest_amount;l=l>=1e4?l/1e4+"万美元":"$"+l,a+='<div class="order_list"><h4>'+t[e].product_name+" "+t[e].product_number+'</h4><ul class="invest_table clearfix"><li>预计年化收益：'+t[e].return_rate+"%</li><li>投资期限："+t[e].invest_term+"个月</li><li>起投金额："+l+"</li><li>投资状态："+t[e].status_desc+'</li><li></li><li><a class="status_btn" href='+o+' target="_blank">完善流程</a></li></ul></div>'}),$(".not_order").html(a)))}function d(t){var a="";return t.length<1?($(".invest_order").html("暂无投资订单"),!1):void(t&&t.length>=1&&($.each(t,function(e){var o="",l="$0",n="$0",r="$0",d="$0",i="$0",s="$0",_="$0",c="$0";""!=t[e].total_amount&&null!=t[e].total_amount&&(l="$"+t[e].total_amount),""!=t[e].total_income&&null!=t[e].total_income&&(n="$"+t[e].total_income),""!=t[e].invest_amount&&null!=t[e].invest_amount&&(r="$"+t[e].invest_amount),""!=t[e].received_amount&&null!=t[e].received_amount&&(d="$"+t[e].received_amount),""!=t[e].received_balance&&null!=t[e].received_balance&&(i="$"+t[e].received_balance),""!=t[e].withdraw_able_amount&&null!=t[e].withdraw_able_amount&&(s="$"+t[e].withdraw_able_amount),""!=t[e].invest_income&&null!=t[e].invest_income&&(_="$"+t[e].invest_income),""!=t[e].promotion_income&&null!=t[e].promotion_income&&(c="$"+t[e].promotion_income),""!=t[e].promotion_name&&null!=t[e].promotion_name&&(o=t[e].promotion_name+": $"+t[e].promotion_value);var u,p="";u=t[e].withdraw_able_amount>0?"":'disabled style="background:#ccc"',t[e].can_withdraw&&(p='<button class="status_btn" data-toggle="modal" data-titlename='+t[e].product_name+" "+t[e].product_number+' data-target="#popup" '+u+" data-order-number = "+t[e].order_number+">提现</button>",t[e].has_withdraw_record&&(p='<button class="status_btn" data-toggle="modal" data-titlename="'+t[e].product_name+" "+t[e].product_number+'" data-target="#popup" '+u+" data-order-number = "+t[e].order_number+'>提现</button><button style="margin-left: 20px;" type="button" class="withdraw" data-order-number='+t[e].order_number+">提现记录</button>")),a+='<div class="order_list"><h4>'+t[e].product_name+" "+t[e].product_number+'<span class="invest_status">投资状态：'+t[e].status_desc+'</span></h4><ul class="invest_table clearfix"><li>产品类型：债权型</li><li>总金额：'+l+"</li><li>累计收益："+n+"</li><li>投资日期："+t[e].created_at+"</li><li>投资周期："+t[e].invest_term+'个月</li><li><button class="status_btn more" data-show="0">显示更多</button></li><li class="hide">投资总额： '+r+'</li><li class="hide">入金金额：'+d+'</li><li class="hide">入金余额：'+i+'</li><li class="hide">可提现金额：'+s+'</li><li class="hide">投资收益：'+_+'</li><li class="hide">权益收益：'+c+'</li><li class="hide">'+o+'</li><li class="hide"><a href='+t[e].sub_doc_url+' target="_blank">合同</a></li><li class="hide">'+p+"</li></ul></div>"}),$(".invest_order").html(a),_(),c(),$(".invest_order").on("click",".withdraw",function(){var t=$(this),a=$(this).prev().attr("data-order-number");y=$(this).attr("data-type"),t.parents(".invest_table").nextAll().remove();var e={order_number:a};e=$.extend({},e,cookie_tooken),$.when(Ajax_Data({url:baseUrl+"/withdraw/list",data:e,async:!1,fn:f})).done(t.parents(".invest_table").after(g))})))}function i(t){var a="";return t.length<1?($(".history_order").html("暂无投资订单"),!1):void(t&&($.each(t,function(e){var o="";t[e].has_withdraw_record&&(o="OPEN"==t[e].operation_mode?'<li></li><li></li><li><button type="button" class="withdraw" data-order-number='+t[e].order_number+">赎回记录</button></li>":'<li></li><li></li><li><button type="button" class="withdraw" data-order-number='+t[e].order_number+">提现记录</button></li>"),a+='<div class="order_list"><h4>'+t[e].product_name+" "+t[e].product_number+' <span class="redeem_date">赎回日期：d[i].refund_date</span></h4><ul class="invest_table clearfix"><li>产品类型：债券型</li><li>总金额：$'+t[e].total_amount+"</li><li>累计收益：$"+t[e].total_income+"</li><li>投资日期："+t[e].created_at+"</li><li>投资金额：$"+t[e].invest_amount+"</li><li>赎回金额：$"+t[e].refund_amount+"</li>"+o+"</ul></div>"}),$(".history_order").html(a),$(".history_order").on("click",".withdraw",function(){var t=$(this),a=$(this).prev().attr("data-order-number");y=$(this).attr("data-type"),t.parents(".invest_table").nextAll().remove();var e={order_number:a};e=$.extend({},e,cookie_tooken),$.when(Ajax_Data({url:baseUrl+"/withdraw/list",data:e,async:!1,fn:f})).done(t.parents(".invest_table").after(g))})))}function s(t){var a="";if(t.length<1)return $(".flexible_invest").html("暂无灵活理财订单"),!1;if(t){var e=0,o=0,l=0,n="";$.each(t,function(r){""!=t[r].total_income&&null!=t[r].total_income&&(e=t[r].total_income),""!=t[r].received_amount&&null!=t[r].received_amount&&(o=t[r].received_amount),""!=t[r].received_balance&&null!=t[r].received_balance&&(l=t[r].received_balance);var d;d=t[r].withdraw_able_amount>0?"":'disabled style="background:#ccc"',t[r].can_withdraw&&(n='<button class="status_btn" data-toggle="modal" data-titlename='+t[r].product_name+" "+t[r].product_number+' data-target="#popup" '+d+" data-order-number = "+t[r].order_number+">赎回</button>",t[r].has_withdraw_record&&(n='<button class="status_btn" data-toggle="modal" data-titlename="'+t[r].product_name+" "+t[r].product_number+'" data-target="#popup" '+d+" data-order-number = "+t[r].order_number+'>赎回</button> <button type="button" class="withdraw-history status_btn" data-type='+t[r].operation_mode+">赎回记录</button>")),a+='<div class="order_list"><h4>'+t[r].product_name+" "+t[r].product_number+'</h4><ul class="invest_table clearfix"><li>产品类型：债券型</li><li>总金额：$'+t[r].total_amount+"</li><li>累计收益：$"+e+"</li><li>投资日期："+t[r].created_at+"</li><li>最新NAV："+t[r].current_nav+"</li><li>投资状态："+t[r].status_desc+"</li><li>投资金额：$"+t[r].invest_amount+"</li><li>入金金额：$"+o+"</li><li>入金余额：$"+l+"</li><li>份&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数："+t[r].left_count+"</li><li>购买时NAV："+t[r].first_nav+"</li><li>投资周期："+t[r].invest_term+"月起</li><li></li><li><a href="+t[r].sub_doc_url+'>合同</a></li><li><button class="status_btn buy_again">再次购买</button> '+n+"</li></ul></div>"}),$(".flexible_invest").html(a),$(".flexible_invest").on("click",".withdraw-history",function(){var t=$(this),a=$(this).prev().attr("data-order-number");y=$(this).attr("data-type"),t.parents(".invest_table").nextAll().remove();var e={order_number:a};e=$.extend({},e,cookie_tooken),$.when(Ajax_Data({url:baseUrl+"/withdraw/list",data:e,async:!1,fn:f})).done(t.parents(".invest_table").after(g))})}$(".flexible_invest").on("click",".buy_again",function(){window.location="/fa_invest/invest_yellowstone_step_1.html"}),u()}function _(){$(".order_list .more").each(function(){var t=$(this);t.on("click",function(){var a=t.attr("data-show");0==a?(t.text("隐藏更多"),t.attr("data-show",1),t.parents("li").nextAll().removeClass("hide")):(t.text("显示更多"),t.attr("data-show",0),t.parents("li").nextAll().addClass("hide"))})})}function c(){$("#popup").on("show.bs.modal",function(t){var a=$(t.relatedTarget),e=a.data("titlename"),o=$(this);o.find(".modal-title span").empty(),o.find(".modal-title").prepend("<span>"+e+"提现</span>"),o.find(".modal-body").empty();var l='<div class="error_msg"></div><form id="invest_form"><label>用户名：</label><input id="full_name" class="form-control"><label>现居地址：</label><input id="residence-address" class="form-control"><label>收款银行名称：</label><input id="bank_name" class="form-control"><label>收款银行地址：</label><input id="bank_address" class="form-control"><label>收款银行账户：</label><input id="account_name" class="form-control"><label>Swift Code：</label><input id="swift_code" class="form-control"><label>ABA Number：</label><input id="routing_number" class="form-control"><label>投资总额：</label><input id="invest_total" disabled class="form-control" style="width:30%;float:left"><label style="clear:none">可提现金额：</label><input id="interest_amount" class="form-control" disabled style="width:30%;float:left"><label>提现金额：</label><input id="invest_value" class="form-control"><div class="text-center"><button type="button" class="btn btn-primary" style="width:30%" id="get_view">生成预览</button></div></form>';o.find(".modal-body").append(l),$("#full_name").val(A),$("#residence-address").val(U),order_number=a.data("order-number");var n={order_number:order_number};n=$.extend({},n,cookie_tooken),Ajax_Data({url:baseUrl+"/order/"+order_number,data:n,fn:m}),Ajax_Data({url:baseUrl+"/profile/bank/get",data:cookie_tooken,fn:v})}),$("body").on("click","#get_view",function(){var t=$(".modal-body input"),a=!0;if($.each(t,function(e){""==t.eq(-(e+1)).val()&&(console.log(-e),$(".error_msg").html(t.eq(-(e+1)).prev("label").html().replace("：","")+"不能为空"),a=!1)}),a){$(".modal-body").hide();var e='<table><tr><td>用户名：</td><td colspan="3">user_name</td></tr><tr><td>现居地址：</td><td colspan="3">address</td></tr><tr><td>收款银行名称：</td><td colspan="3">bank_name</td></tr><tr><td>收款银行地址：</td><td colspan="3">bank_address</td></tr><tr><td>收款银行账户：</td><td colspan="3">bank_account</td></tr><tr><td>Swift Code：</td><td colspan="3">swift_code</td></tr><tr><td>ABA Number：</td><td colspan="3">aba_number</td></tr><tr><td>投资总额：</td><td width="30%">invest_total</td><td width="20%">可提现金额：</td><td width="30%">withdraw_able_amount</td></tr><tr><td>提现金额：</td><td colspan="3">withdraw_amount</td></tr></table>';e=e.replace("user_name",$("#full_name").val()),e=e.replace("address",$("#residence-address").val()),e=e.replace("bank_name",$("#bank_name").val()),e=e.replace("bank_address",$("#bank_address").val()),e=e.replace("bank_account",$("#account_name").val()),e=e.replace("swift_code",$("#swift_code").val()),e=e.replace("aba_number",$("#routing_number").val()),e=e.replace("invest_total",$("#invest_total").val()),e=e.replace("withdraw_able_amount",$("#interest_amount").val()),e=e.replace("withdraw_amount",$("#invest_value").val()),e+='<div class="text-center"><button type="button" id="back_prev" class="btn" style="width:8em">返  回</button> <button type="button" id="invest_submit" class="btn btn-primary" style="width:8em">确认提现</button></div>',$(".modal-body-success").html(e),$(".modal-body-success").show()}return!1}),$("body").on("click","#back_prev",function(){return $(".modal-body-success").hide(),$(".modal-body").show(),!1}),$("body").on("click","#invest_submit",function(){function t(t){$(".modal-body-success").hide(),$(".modal-footer").html("<p>提交成功</p>您的提现申请已提交成功，我们会尽快办理，请您保持通讯畅通，以方便与您联系。").show()}var a={order_number:order_number,withdraw_amount:$("#invest_value").val(),user_name:$("#full_name").val(),user_address:$("#residence-address").val(),bank_name:$("#bank_name").val(),bank_address:$("#bank_address").val(),account_number:$("#bank_address").val(),swift_code:$("#bank_address").val(),routing_number:$("#bank_address").val()};return a=$.extend({},a,cookie_tooken),Ajax_Data({type:"post",url:baseUrl+"/withdraw/submit",data:a,fn:t,fail_fn:h}),!1}),$("body").on("click",".modal-body .close,.modal-body-success .close",function(){return $(".modal-body-success").hide(),$(".modal-footer").html(" ").hide(),$(".modal-body").show(),!1}),$("body").on("click",".modal-footer .close",function(){return window.location.reload(),!1})}function u(){$("#popup").on("show.bs.modal",function(t){var a=$(t.relatedTarget),e=a.data("titlename"),o=$(this);o.find(".modal-title span").empty(),o.find(".modal-title").prepend("<span>"+e+"赎回</span>"),o.find(".modal-body").empty();var l='<div class="error_msg"></div><form id="invest_form"><div class="clearfix"><label>用户名：</label><input id="full_name" class="form-control"><label>现居地址：</label><input id="residence-address" class="form-control"><label>收款银行名称：</label><input id="bank_name" class="form-control"><label>收款银行地址：</label><input id="bank_address" class="form-control"><label>收款银行账户：</label><input id="account_name" class="form-control"><label>Swift Code：</label><input id="swift_code" class="form-control"><label>ABA Number：</label><input id="routing_number" class="form-control"></div><div class="text-center flexibleWithDraw"><div class="clearfix"><input type="radio" name="redeem_type" value="true" id="part" checked><label class="radio_label" for="part">部分赎回</label><input type="radio" name="redeem_type" value="false" id="all"><label class="radio_label" for="all">全部赎回</label></div><label class="withdraw_number">赎回份额：</label><input type="text" class="form-control"  id="withdraw_value"><br><p class="text-left blue">温馨提示：您的赎回份数需满足(500.00&lt;赎回份额&lt;4000.00),详情见规则，第一次赎回时候我们将把账户内的入金余额一并赎回。</p></div><div class="text-center"><button type="button" class="btn btn-primary" style="width:30%" id="get_view">生成预览</button></div></form>';o.find(".modal-body").append(l),$("#full_name").val(A),$("#residence-address").val(U),order_number=a.data("order-number");var n={order_number:order_number};n=$.extend({},n,cookie_tooken),Ajax_Data({url:baseUrl+"/order/"+order_number,data:n,fn:b}),Ajax_Data({url:baseUrl+"/profile/bank/get",data:cookie_tooken,fn:v})}),$("body").on("click","#get_view",function(){var t=$(".modal-body input.form-control");console.log(t.length);var a=!0;if($.each(t,function(e){""==t.eq(-(e+1)).val()&&(console.log(-(e+1)),console.log(t.eq(-(e+1)).prev("label").html()),console.log(t.eq(-(e+1)).prev("label").html().replace("：","")),$(".error_msg").html(t.eq(-(e+1)).prev("label").html().replace("：","")+"不能为空"),a=!1)}),a){$(".modal-body").hide();var e='<table><tr><td>用户名：</td><td colspan="3">user_name</td></tr><tr><td>现居地址：</td><td colspan="3">address</td></tr><tr><td>收款银行名称：</td><td colspan="3">bank_name</td></tr><tr><td>收款银行地址：</td><td colspan="3">bank_address</td></tr><tr><td>收款银行账户：</td><td colspan="3">bank_account</td></tr><tr><td>Swift Code：</td><td colspan="3">swift_code</td></tr><tr><td>ABA Number：</td><td colspan="3">aba_number</td></tr><tr><td>赎回份额：</td><td colspan="3">withdraw_amount</td></tr></table>';e=e.replace("user_name",$("#full_name").val()),e=e.replace("address",$("#residence-address").val()),e=e.replace("bank_name",$("#bank_name").val()),e=e.replace("bank_address",$("#bank_address").val()),e=e.replace("bank_account",$("#account_name").val()),e=e.replace("swift_code",$("#swift_code").val()),e=e.replace("aba_number",$("#routing_number").val()),e=e.replace("withdraw_amount",$("#withdraw_value").val()),e+='<div class="text-center"><button type="button" id="back_prev" class="btn" style="width:8em">返  回</button> <button type="button" id="invest_submit" class="btn btn-primary" style="width:8em">确认提现</button></div>',$(".modal-body-success").html(e),$(".modal-body-success").show()}return!1}),$("body").on("click","#back_prev",function(){return $(".modal-body-success").hide(),$(".modal-body").show(),!1}),$("body").on("click","#invest_submit",function(){function t(t){$(".modal-body-success").hide(),$(".modal-footer").html("<p>提交成功</p>您的提现申请已提交成功，我们会尽快办理，请您保持通讯畅通，以方便与您联系。").show()}var a={order_number:order_number,withdraw_count:$("#withdraw_value").val(),user_name:$("#full_name").val(),user_address:$("#residence-address").val(),bank_name:$("#bank_name").val(),bank_address:$("#bank_address").val(),account_number:$("#bank_address").val(),swift_code:$("#bank_address").val(),routing_number:$("#bank_address").val()};return a=$.extend({},a,cookie_tooken),Ajax_Data({type:"post",url:baseUrl+"/withdraw/submit",data:a,fn:t,fail_fn:h}),!1}),$("body").on("click",".modal-body .close,.modal-body-success .close",function(){return $(".modal-body-success").hide(),$(".modal-footer").html(" ").hide(),$(".modal-body").show(),!1}),$("body").on("click",".modal-footer .close",function(){return window.location.reload(),!1})}function p(t){function a(t){alert("修改成功"),t.prop("disabled",!1)}function e(t){alert(t),t.prop("disabled",!1)}var o=$("#id_old_password").val(),l=$("#id_password").val(),n=$("#id_password_confirm").val(),r=!0;if(""==o&&($("#id_old_password").after("<span>请输入原密码</span>"),r=!1),""==l?($("#id_password").after("<span>请输入新密码</span>"),r=!1):l.length<6&&($("#id_password").after("<span>密码长度不能少于6位</span>"),r=!1),""==n&&($("#id_password_confirm").after("<span>请再次输入新密码</span>"),r=!1),o==l&&""!=o&&($("#id_password").after("<span>新密码不能与原密码一致</span>"),r=!1),n!=l&&""!=l&&""!=n&&($("#id_password_confirm").after("<span>您输入的两次密码不一致</span>"),r=!1),r){var d={old_password:o,password:l};d=$.extend({},d,cookie_tooken),Ajax_Data({url:baseUrl+"/auth/change_password",type:"post",data:d,fn:a,fail_fn:e})}}function m(t){t&&("OFF_SHORE"==t.product_location&&"NON_CROWD_FUNDING"==t.product_type&&"CLOSED"==t.operation_mode?$("#invest_value").val(t.withdraw_able_amount).attr("disabled",!0):$("#invest_value").val(t.withdraw_able_amount),$("#invest_total").val(t.invest_amount),$("#interest_amount").val(t.withdraw_able_amount))}function b(t){if(t){var a=t.left_count;value_true="温馨提示：您的赎回份数需满足("+t.min_withdraw_count+"&lt;赎回份额&lt;"+t.max_withdraw_count+"),详情见规则，第一次赎回时候我们将把账户内的入金余额一并赎回。",value_false="温馨提示：您全部赎回的份额是"+a+"，第一次赎回时候我们将把账户内的入金余额一并赎回。",$(".flexibleWithDraw p").html(value_true),$("body").on("change",'.flexibleWithDraw input[type="radio"]',function(t){console.log(t.target.id),"part"==t.target.id&&($("#withdraw_value").val(" ").prop("disabled",!1),$(".flexibleWithDraw p").html(value_true)),"all"==t.target.id&&($("#withdraw_value").val(a).prop("disabled",!0),$(".flexibleWithDraw p").html(value_false))})}}function v(t){$("#bank_name").val(t.bank_name),$("#bank_address").val(t.bank_address),$("#account_name").val(t.account_name),$("#swift_code").val(t.swift_code),$("#routing_number").val(t.routing_number)}function h(t){alert(t)}function f(t){t&&$.each(t,function(a){g="OPEN"==y?'<div class="withdraw_list"><ul class="invest_table clearfix"><li>赎回金额: '+t[a].amount+"</li><li>赎回时净值: "+t[a].withdraw_net_value+"</li><li>赎回日期: "+t[a].withdraw_date+"</li><li>赎回份数: "+t[a].count+"</li><li>购买时净值: "+t[a].buy_net_value+"</li><li>状态: "+t[a].status+"</li></ul></div>":'<div class="withdraw_list"><ul class="invest_table clearfix"><li>提现时间: '+t[a].withdraw_date+"</li><li>提现金额: $"+t[a].amount+"</li><li>状态: "+t[a].status+"</li></ul></div>"})}function w(t){var a=new FormData($("form")[0]);a.append("file",t[0].files[0]),a.append("mx_token",mx_token),a.append("mx_secret",mx_secret),$.ajax({url:baseUrl+"/upload/user_file",dataType:"json",type:"post",data:a,async:!1,cache:!1,contentType:!1,processData:!1,success:function(t,a){1==t.code&&("id_identification_card_photo"==event.target.id&&(id_card_photo=t.body,default_id_card_photo=!1),"id_passport_photo"==event.target.id&&(passport_photo=t.body,default_passport_photo=!1)),t.code==-1&&alert("上传失败,请重新上传")}})}var y,g="",k="yyyy-mm-dd",x=new RegExp(k.replace(/(\w+)\W(\w+)\W(\w+)/,"^\\s*($1)\\W*($2)?\\W*($3)?([0-9]*).*").replace(/m|d|y/g,"\\d")),D="$1/$2/$3$4".replace(/\//g,k.match(/\W/));$("#id_birth_date").keyup(function(a){a.ctrlKey||a.metaKey||!(32==a.keyCode||a.keyCode>46)||t(a.target)});var A,U;Ajax_Data({url:baseUrl+"/auth/authentication",data:cookie_tooken,fn:e,no_login:a})});