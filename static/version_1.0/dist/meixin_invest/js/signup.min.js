$.cookie("mx_token","",{expires:-1}),$.cookie("mx_secret","",{expires:-1}),$(document).ready(function(){$(".registration-form .div-group:first").fadeIn("slow"),$('.registration-form input[type="text"], .registration-form input[type="password"], .registration-form textarea').on("focus",function(){$(this).removeClass("input-error")});var e=!0;$("#get_verify").click(function(){var r=$(this);$(this).prop("disabled",!0);var i=$("#id_telephone").val(),n=$("#countries_phone").val(),a=null,t=60;return a=setInterval(function(){$("#get_verify").html(t+"秒后重发"),t--,0==t&&(clearInterval(a),r.prop("disabled",!1),r.html("重新发送"),t=60)},1e3),("China"!=n&&i.length>6||"China"==n&&i.length>=15)&&$.ajax({type:"post",url:baseUrl+"/verify_code/send",data:{phone:i},dataType:"json",success:function(r){1==r&&(e=!0),0==r&&alert("验证码获取失败")}}),!1});var r={};$("#id_referral_code").on("blur",function(){var e=$.trim($("#id_referral_code").val());return r.referral_code=e,""!=e&&$.ajax({type:"get",url:baseUrl+"/verifyReferralCode",data:r,success:function(e){return 1==e.code&&($(".page1-error-div").html("<div class='alert alert-warning' style='height: 45px; margin-top: -18px; background-color: #fff; border: none; font-size: 12px; color: orangered'>邀请码有效  注册成功后礼品卡将发送至您的邮箱!</div>"),$(".page2-error-div").html("<div class='alert alert-warning' style='font-size: 12px; color: orangered'>邀请码有效  注册成功后礼品卡将发送至您的邮箱!</div>")),2==e.code||3==e.code?($(".page1-error-div").html("<div class='alert alert-warning' style='height: 45px; margin-top: -18px; background-color: #fff; border: none; font-size: 12px; color: orangered'>亲爱的用户，邀请码失效,活动礼品已全部派完，感谢您对美信金融的关注!</div>"),$(".page2-error-div").html("<div class='alert alert-warning' style='font-size: 12px; color: orangered'>亲爱的用户，邀请码失效,活动礼品已全部派完，感谢您对美信金融的关注!</div>"),!1):4==e.code?($(".page1-error-div").html("<div class='alert alert-warning' style='height: 45px; margin-top: -18px; background-color: #fff; border: none; font-size: 12px; color: orangered'>亲爱的用户,您的验证码错误,请核对后填写!</div>"),$(".page2-error-div").html("<div class='alert alert-warning' style='font-size: 12px; color: orangered'>亲爱的用户,您的验证码错误,请核对后填写!</div>"),!1):void 0}}),!1}),$("#id_referral_code").on("focus",function(){$(".alert").remove()}),$(".registration-form #first-page-next-btn").on("click",function(){var i=$(this).parents(".div-group"),n=!0;i.find('input[name="phone"]'),i.find('input[name="verifyCode"]'),i.find('input[type="password"]'),i.find('input[name="email"]');if(i.find('input[name="phone"], input[name="verifyCode"], input[type="password"], input[name="email"]').each(function(){if("China"==$("#countries_phone").val()&&$('input[name="phone"]').val().length<15)return $(this).addClass("input-error"),n=!1,!1;if("China"!=$("#countries_phone").val()&&$('input[name="phone"]').val().length<6)return $(this).addClass("input-error"),n=!1,!1;if($('input[name="verifyCode"]').val().length<6)return $("#id_verify").addClass("input-error"),n=!1,!1;if(""==$("#id_password").val())return $("#id_password").addClass("input-error"),n=!1,!1;if(""==$(this).val())return $(this).addClass("input-error"),n=!1,!1;var e=$("#id_email").val();return e.indexOf("@")==-1||e.indexOf(".")==-1?($("#id_email").addClass("input-error"),n=!1,!1):void $(this).removeClass("input-error")}),e){if(n){i.fadeOut(400,function(){$("#page1").next().fadeIn()});var a=$.trim($("#id_email").val());r.email=a,r.password=$("#id_password").val(),r.phone=$.trim($("#id_telephone").val()),r.country=$("#countries_phone").val(),r.verify_code=$("#id_verify").val(),r.referral_code=$("#id_referral_code").val()}}else alert("请获取手机验证码!")}),$(".registration-form .btn-previous").on("click",function(){$(this).parents("#page2").fadeOut(400,function(){$(this).prev().fadeIn()})}),$(".registration-form #investor-type-next-btn").on("click",function(){var e=$(this).parents("#page2"),i=!0,n=$("input[name=is_international_investor]:checked").val();e.find('input[name="is_international_investor"]').each(function(){$('input[name="is_international_investor"]').is(":checked")?$(this).removeClass("input-error"):($(this).addClass("input-error"),i=!1,$(".page2-error-div").html("<div class='alert alert-warning'>请选择您的投资者类型</div>"))}),i&&(console.log(n),r.is_international_investor=$(".form-group").find("input[type='radio']:checked").val(),"True"==n?e.fadeOut(400,function(){$("#international_page3").fadeIn()}):e.fadeOut(400,function(){$("#american_page3").fadeIn()}))}),$(".registration-form .btn-previous").on("click",function(){$(this).parents(".page3").fadeOut(400,function(){$("#page2").fadeIn()})}),$("#american-submit").on("click",function(){return r.questionaire_answer=$("#american_page3").find("input[type='radio']:checked").val(),$('input[name="questionaire_answer"]').is(":checked")?$('input[name="american-agree"]').is(":checked")?$.ajax({type:"post",url:baseUrl+"/auth/signup",data:r,success:function(e){if(1==e.code){var r=e.body;$.cookie("mx_token",r.mx_token,{expires:30}),$.cookie("mx_secret",r.mx_secret,{expires:30}),window.location.href="/"}else 1!=e.code&&($(".page3-error-div").html("<div class='alert alert-warning'>"+e.msg+"</div>"),$(".page2-error-div").html("<div class='alert alert-warning'>"+e.msg+"</div>"),$(".page1-error-div").html("<div class='alert alert-warning'>"+e.msg+"</div>"))}}):$(".page3-error-div").html("<div class='alert alert-warning'>请同意网站的使用条款和隐私协议</div>"):$(".page3-error-div").html("<div class='alert alert-warning'>请选择您的投资者条件</div>"),!1}),$("#international-submit").on("click",function(){return $('input[name="international-agree"]').is(":checked")?$('input[name="international-agree"]').is(":checked")&&$.ajax({type:"post",url:baseUrl+"/auth/signup",data:r,success:function(e){if(1==e.code){var r=e.body;$.cookie("mx_token",r.mx_token,{expires:30}),$.cookie("mx_secret",r.mx_secret,{expires:30}),window.location.href="/"}else 1!=e.code&&($("#international-page3-error-div").html("<div class='alert alert-warning'>"+e.msg+"</div>"),$(".page2-error-div").html("<div class='alert alert-warning'>"+e.msg+"</div>"),$(".page1-error-div").html("<div class='alert alert-warning'>"+e.msg+"</div>"))}}):$("#international-page3-error-div").html("<div class='alert alert-warning'>请同意网站的使用条款和隐私协议</div>"),!1})});