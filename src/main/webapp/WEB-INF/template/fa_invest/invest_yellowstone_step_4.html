<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'/>
    <title>
        美信金融|投资流程
    </title>
    <script src="/static/vendor/js/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="/static/dist/meixin_invest/js/jquery.cookie.min.js"></script>
    <script src="/static/meixin_invest/js/is_ok.js"></script>
    <link rel="stylesheet" href="/static/vendor/css/bootstrap.min.css">
    <link href="/static/dist/meixin_invest/css/base.min.css" rel="stylesheet">
    <link href="/static/dist/meixin_invest/css/detail-new.min.css" rel="stylesheet">
    <link href="/static/dist/meixin_invest/css/index.min.css" rel="stylesheet">
    <link href="/static/meixin_invest/css/fa_invest.css" rel="stylesheet">
    <link href="/static/meixin_invest/css/agreement-forms.css" rel="stylesheet">
    <#include "includes/oneapm.html" />
    <#include "includes/ga.html" />
    <script>
        var _hmt = _hmt || [];
        (function () {
                    var hm = document.createElement("script");
                    hm.src = "//hm.baidu.com/hm.js?36100da860ed74085d2bdd67bdbdbf5e";
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(hm, s);
                })();
    </script>
    <!--[if lt IE 9]>
    <script src="/static/vendor/js/html5shiv"></script>
    <script src="/static/vendor/js/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div id="wrapper" class="customer">
    <#include "includes/navbar.html" />
    <div class="container-fluid">
        <section class="text-center" style="margin-top: 70px;">
            <div class="row">
                <div class="col-sm-10 col-sm-offset-1">
                    <div class="fa-steps-bullets international-bullets-extra-styles yellow-bullets-point">
                        <div style="width:19%"><p><span>1</span></p>个人信息</div>
                        <div><p><span>2</span></p>合规信息</div>
                        <div><p><span>3</span></p>护照证件上传</div>
                        <div><p class="active"><span>4</span></p>地址证明上传</div>
                        <div><p><span>5</span></p>签字确认</div>
                        <hr/>
                        <span class="clearfix"></span>
                    </div>
                    <form class="fa-steps col-sm-10 col-sm-offset-1" data-parsley-validate>
                        <div class="step-section text-left label-left radio-custom">
                            <p>根据监管要求, 投资人需要上传身份证件及地址证明以核实投资者身份信息。</p>
                            <div class="fa-upload-passport-pic fa-upload-pic col-sm-5">
                                <a class="btn btn-primary">点击上传地址证明</a>
                                <img src="/static/meixin_invest/img/upload_address_proof_placeholder_325x198.png">
                                <p>要求：请上传地址证明，字迹清晰，四边完整</p>
                                <input id="address-proof" name="address-proof" type="file"
                                       data-parsley-required-message="请上传地址证明！" required style="display: none;"/>
                            </div>
                            <div class="fa-upload-passport-pic fa-upload-pic col-sm-5 col-sm-offset-2">
                                <p>请在以下文件类型中选择一项进行上传</p>
                                <p>符合要求的地址证明包括:</p>
                                <p>1.有效的身份证</p>
                                <p>2.三个月内的银行账单(必须包含姓名与住址)</p>
                                <p>3.三个月内的电费、水费、网络或电话账单(必须包含姓名与住址)</p>
                                <p>4.有效的居住证、暂住证、房产证、户口本（必须包含姓名与住址）</p>
                            </div>
                            <span class="clearfix"></span>
                            <p>提示：填写的地址应该与地址证明上的地址一致</p>
                            <label>居住国家 <!--/ Resident Country--></label>
                            <select id="resident-countries-states" style="width: 84%;"
                                    class="form-control bfh-countries"
                                    data-country="China"
                                    required=""></select>
                            <label>省份/州 <!--/ State--></label>
                            <input id="resident-state" class="form-control"
                                   placeholder="请填写省份或州的拼音或英语，例如”河北省“请填写“Hebei”" required="">
                            <label>城市 <!--/ City--></label>
                            <input id="resident-city" class="form-control"
                                   placeholder="请填写城市名的拼音，例如”北京市“请填写“Beijing”" required="">
                            <label>街道名 <!--/ Street--></label>
                            <input id="resident-street" class="form-control"
                                   placeholder="请填写街道名的拼音，例如“人民路”请填写“Renminlu”" required="">
                            <label>门牌号码<!-- / Door Number--></label>
                            <input id="resident-door" class="form-control"
                                   placeholder="请填写街道的门牌号码，例如“人民路1号”请填写“1”" required="">
                            <label>公寓号 <!--/ Apartment Number--></label>
                            <input id="resident-apartment" class="form-control"
                                   placeholder="请填写公寓房间号码，例如“601室”请填写”Room 601“">
                            <label>邮政编码 <!--/ Zipcode--></label>
                            <input id="resident-zipcode" class="form-control" placeholder="请填写准确的邮政编码" required="">
                            <!-- <p>固定居住地址 / Permanent Residence Address</p> -->
                            <input type="checkbox" name="perResidenceAddr" id="is-address-permanent"
                                   checked="checked"/>
                            <label for="perResidenceAddr"><span><span class="invest-check-mark"></span></span>固定居住地址与居住地址一致</label>
                            <div id="permanent-residence-address" style="display: none;">
                                <p>如果固定居住地址与现居住地址不一致，请发送邮件至<a
                                        href="mailto:invest@meixinfinance.com?Subject=固定居住地址与现居住地址不同原因" target="_top">invest@meixinfinance.com</a>
                                    说明原因</p>
                                <label>固定居住地址国家 / Permanent Country</label>
                                <select id="permanent-countries-states" style="width: 84%;"
                                        class="form-control bfh-countries"
                                        data-country="China"
                                        required=""></select>
                                <label>固定居住地址省份/州 / Permanent State</label>
                                <input id="permanent-state" class="form-control"
                                       placeholder="请填写省份或州的拼音或英语，例如”河北省“请填写“Hebei”">
                                <label>固定居住地址城市 / Permanent City</label>
                                <input id="permanent-city" class="form-control"
                                       placeholder="请填写城市名的拼音，例如”北京市“请填写“Beijing”">
                                <label>固定居住地址街道名 / Permanent Street</label>
                                <input id="permanent-street" class="form-control"
                                       placeholder="请填写街道名的拼音，例如“人民路”请填写“Renminlu”">
                                <label>固定居住地址门牌号码 / Permanent Door Number</label>
                                <input id="permanent-door" class="form-control"
                                       placeholder="请填写街道的门牌号码，例如“人民路1号”请填写“1”">
                                <label>固定居住地址公寓号 / Permanent Apartment Number</label>
                                <input id="permanent-apartment" class="form-control"
                                       placeholder="请填写公寓房间号码，例如“601室”请填写”Room 601“">
                                <label>固定居住地址邮政编码 / Permanent Zipcode</label>
                                <input id="permanent-zipcode" class="form-control" placeholder="请填写准确的邮政编码">
                            </div>
                        </div>

                        <div class="step-navigation">
                            <button type="button" class="previous btn btn-primary pull-left">返回</button>

                            <button type="fasubmit" id="submit_step_four" class="btn btn-primary pull-right"><span
                                    class="glyphicon glyphicon-refresh spinning"
                                    style="display: none;"></span><span>下一步</span></button>
                            <span class="clearfix"></span>
                        </div>
                    </form>
                    <input type="hidden" id="step_four_entity_id" value="${entity_id}"/>

                </div>

            </div>
        </section>
    </div>
</div>
<link rel="shortcut icon" type="image/png" href="/static/dist/meixin_invest/img/favicon.png">
<link rel="stylesheet" href="/static/vendor/css/font-awesome.min.css">
<script src="/static/vendor/js/jquery-ui.min.js" type="text/javascript"></script>
<script src="/static/vendor/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/static/dist/meixin_invest/js/navi.min.js" type="text/javascript"></script>
<script>
    $(document).ready(function () {
        $('#wechat-popover').popover({
            html: true,
            placement: 'bottom',
            trigger: 'hover',
            content: '<img style="width: 200px;padding:0;margin:0;" src="/static/meixin_invest/img/meixin_new_qr_code_300x300.jpg" />'
        });
    });
</script>
<script src="/static/dist/meixin_invest/js/bootstrap-formhelpers-yellowstone.min.js" type="text/javascript"></script>
<script src="/static/dist/meixin_invest/js/bootstrap-formhelpers-countries.zh_CN.min.js"
        type="text/javascript"></script>
<script src="/static/dist/meixin_invest/js/bootstrap-formhelpers-phone.min.js" type="text/javascript"></script>
<script src="/static/meixin_invest/js/parsley.min.js"></script>
<script src="/static/dist/meixin_invest/js/fa_invest_general.min.js"></script>
<script src="/static/dist/meixin_invest/js/fa.min.js"></script>
<script>
    $(function () {
        // hide or display permanent address display
        $("#is-address-permanent").change(function () {
            if (!$("#is-address-permanent").is(':checked')) {
                $("#permanent-residence-address").show();
                $("#permanent-state").attr("required", "");
                $("#permanent-city").attr("required", "");
                $("#permanent-street").attr("required", "");
                $("#permanent-apartment").attr("required", "");
                $("#permanent-door").attr("required", "");
                $("#permanent-zipcode").attr("required", "");
            } else {
                $("#permanent-residence-address").hide();
                $("#permanent-state").removeAttr("required");
                $("#permanent-city").removeAttr("required");
                $("#permanent-street").removeAttr("required");
                $("#permanent-apartment").removeAttr("required");
                $("#permanent-door").removeAttr("required");
                $("#permanent-zipcode").removeAttr("required");
            }
        });


        //验证登录
        var mx_token = $.cookie('mx_token'),
                mx_secret = $.cookie('mx_secret');
        cookie_tooken = {mx_token: mx_token, mx_secret: mx_secret};
        Ajax_Data({
            "url": baseUrl + "/auth/authentication",
            "data": cookie_tooken,
            "fn": is_login,
            "fail_fn":login_fail
        });
        function login_fail() {
            window.location = 'https://www.meixinfinance.com/login';
        }
        //is_login  调取登录接口
        function is_login(res) {
            $('.navbar ul li:last-child').html('<a class="btn btn-min-width" href="/investor/dashboard">我的账户</a>');
            $('.navbar ul li:nth-last-child(2)').html('<a class="btn btn-min-width-sm" href="/logout">退出</a>');
            $('.ajax_wait p,.ajax_wait').hide();
            //新建订单
            if(is_new){
                // 获取profile信息
                var get_profile_data = {
                    "fields": "resident_country,resident_region,resident_city,resident_street,resident_door,resident_apartment,resident_zipcode,permanent_country,permanent_region,permanent_city,permanent_street,permanent_door,permanent_apartment,permanent_zipcode"
                };
                var object = $.extend({}, cookie_tooken, get_profile_data);
                var get_profile_data = $.extend({}, get_profile_data, cookie_tooken);
                Ajax_Data({
                    "url": baseUrl + "/profile/get",
                    "data": get_profile_data,
                    "fn": get_profile
                });


                $('#submit_step_four').on('click', function () {
                    $('.ajax_wait').show();
                    setTimeout(function () {
                        $('.ajax_wait p').show();
                    }, 3e3);

                    order_id="7b601f8239fd106cb9a452984ad966b5";

                    //上传profile信息
                    var update_profile_data={};
                    update_profile_data.source_of_income=$('#source-of-investment').val();
                    update_profile_data.tax_country=$('#countries_states').val();
                    update_profile_data.tax_card_type=$('#tax-number-type').val();
                    update_profile_data.tax_card_number=$('#tax-id-number').val();
                    update_profile_data=$.extend({}, update_profile_data, cookie_tooken);
                    Ajax_Data({
                        "type": "post",
                        "url": baseUrl + "/profile/update",
                        "data": update_profile_data,
                        "fn":update_profile
                    });
                    return false;
                })
            }else if(is_old){
                // 获取profile信息
                var get_profile_data = {
                    "fields": "resident_country,resident_region,resident_city,resident_street,resident_door,resident_apartment,resident_zipcode,permanent_country,permanent_region,permanent_city,permanent_street,permanent_door,permanent_apartment,permanent_zipcode"
                };
                var object = $.extend({}, cookie_tooken, get_profile_data);
                var get_profile_data = $.extend({}, get_profile_data, cookie_tooken);
                Ajax_Data({
                    "url": baseUrl + "/profile/get",
                    "data": get_profile_data,
                    "fn": get_profile
                });


                $('#submit_step_four').on('click', function () {
                    $('.ajax_wait').show();
                    setTimeout(function () {
                        $('.ajax_wait p').show();
                    }, 3e3);

                    order_id="7b601f8239fd106cb9a452984ad966b5";
                    //上传profile信息
                    var update_profile_data={};var data = {};
                    update_profile_data.resident_country = $('#resident-countries-states').val();
                    update_profile_data.resident_region = $('#resident-state').val();
                    update_profile_data.resident_city = $('#resident-city').val();
                    update_profile_data.resident_street = $('#resident-street').val();
                    update_profile_data.resident_door = $('#resident-door').val();
                    update_profile_data.resident_apartment = $('#resident-apartment').val();
                    update_profile_data.resident_zipcode = $('#resident-zipcode').val();
                    if (!$("#is-address-permanent").is(':checked')) {
                        update_profile_data.permanent_country = $('#permanent-countries-states').val();
                        update_profile_data.permanent_region = $('#permanent-state').val();
                        update_profile_data.permanent_city = $('#permanent-city').val();
                        update_profile_data.permanent_street = $('#permanent-street').val();
                        update_profile_data.permanent_door = $('#permanent-door').val();
                        update_profile_data.permanent_apartment = $('#permanent-apartment').val();
                        update_profile_data.permanent_zipcode = $('#permanent-zipcode').val();
                    } else {
                        update_profile_data.permanent_country = $('#resident-countries-states').val();
                        update_profile_data.permanent_region = $('#resident-state').val();
                        update_profile_data.permanent_city = $('#resident-city').val();
                        update_profile_data.permanent_street = $('#resident-street').val();
                        update_profile_data.permanent_door = $('#resident-door').val();
                        update_profile_data.permanent_apartment = $('#resident-apartment').val();
                        update_profile_data.permanent_zipcode = $('#resident-zipcode').val();
                    }
                    update_profile_data=$.extend({}, update_profile_data, cookie_tooken);
                    Ajax_Data({
                        "type": "post",
                        "url": baseUrl + "/profile/update",
                        "data": update_profile_data,
                        "fn":update_profile
                    });
                    return false;
                })
            }
        }

        //获取profile信息
        function get_profile(d) {
            if (d.resident_country != "" && d.resident_country != null) {
                $('#resident-countries-states').val(d.resident_country);
            }
            if (d.resident_region != "" && d.resident_region != null) {
                $('#resident-state').val(d.resident_region);
            }
            if (d.resident_city != "" && d.resident_city != null) {
                $('#resident-city').val(d.resident_city);
            }
            if (d.resident_street != "" && d.resident_street != null) {
                $('#resident-street').val(d.resident_street);
            }
            if (d.resident_door != "" && d.resident_door != null) {
                $('#resident-door').val(d.resident_door);
            }
            if (d.resident_apartment != "" && d.resident_apartment != null) {
                $('#resident-apartment').val(d.resident_apartment);
            }
            if (d.resident_zipcode != "" && d.resident_zipcode != null) {
                $('#resident-zipcode').val(d.resident_zipcode);
            }
            if (d.permanent_country != "" && d.permanent_country != null) {
                $('#permanent-countries-states').val(d.permanent_country);
            }
            if (d.permanent_region != "" && d.permanent_region != null) {
                $('#permanent-state').val(d.permanent_region);
            }
            if (d.permanent_city != "" && d.permanent_city != null) {
                $('#permanent-city').val(d.permanent_city);
            }
            if (d.permanent_street != "" && d.permanent_street != null) {
                $('#permanent-street').val(d.permanent_street);
            }
            if (d.permanent_door != "" && d.permanent_door != null) {
                $('#permanent-door').val(d.permanent_door);
            }
            if (d.permanent_apartment != "" && d.permanent_apartment != null) {
                $('#permanent-apartment').val(d.permanent_apartment);
            }
            if (d.permanent_zipcode != "" && d.permanent_zipcode != null) {
                $('#permanent-zipcode').val(d.permanent_zipcode);
            }
        }

        //更新profile信息
        function update_profile(res) {
            $('.ajax_wait p,.ajax_wait').hide();
            window.location.href="http://lcoal.meixinfinance.com:8081/fa_invest/invest_yellowstone_step_5.html?order_id="+order_id;
        }
    });
</script>
</body>
</html>
