<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'/>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <title>
        美信金融|密码找回
    </title>
    <link rel="stylesheet" href="${static}/vendor/css/bootstrap.min.css">
    <link href="${static}/dist/meixin_invest/css/base.min.css" rel="stylesheet">

    <link href="${static}/dist/meixin_invest/css/detail-new.min.css" rel="stylesheet">
    <link href="${static}/dist/meixin_invest/css/index.min.css" rel="stylesheet">
    <#include "includes/oneapm.html" />
    <#include "includes/ga.html" />
    <!--[if lt IE 9]>
    <script src="${static}/vendor/js/html5shiv"></script>
    <script src="${static}/vendor/js/respond.min.js"></script>
    <![endif]-->
    <style>
        #reset_type {
            border-bottom: 1px solid #ededed;
        }

        #reset_type li.reset_type {
            width: 50%;
            margin: 0;
        }

        .nav-pills > li > a {
            border-radius: 0;
            color: #000;
            text-align: center;
        }

        .nav-pills > li.active > a, .nav-pills > li.active > a:focus, .nav-pills > li.active > a:hover {
            background-color: #ecf7fb;
            color: #000;
        }
    </style>
</head>
<body>
<div id="wrapper" class="customer">

    <#include "includes/navbar.html" />


    <div class="customerPage">

        <div id="customerChilantro">
            <div id="content" class="container">

                <div class="row">
                    <div class="col-xs-12">
                        <div class="row">
                            <div class="col-xs-12 col-sm-5 col-sm-offset-4 form-box">

                                <header>

                                </header>
                                <div class="<#if error >alert alert-warning</#if>">
                                    ${error}
                                </div>
                                <div class="wrapper container-fluid" style="padding: 0;">
                                    <h5 id="form-title">密码找回</h5>
                                    <br/>
                                    <br/>
                                    <ul id="reset_type" class="nav nav-pills">
                                        <li class="active reset_type"><a data-toggle="pill" href="#general">手机号
                                        </a></li>
                                        <li class="reset_type"><a data-toggle="pill" href="#invest">邮箱</a></li>
                                    </ul>

                                    <div class="tab-content" style="padding: 40px;">
                                        <div id="general" class="tab-pane fade in active">

                                            <form method="post" action="/account/password_reset_phone">
                                                ${csrf_token}
                                                <div class="container-fluid">
                                                    <div class="form-group">
                                                        <select id="countries_phone"
                                                                class="input-medium bfh-countries form-control"
                                                                data-country="China"
                                                                style="width: 33%;display: inline-block;" required="">
                                                        </select>
                                                        <input class="form-control bfh-phone phone-field" cols="20"
                                                               data-country="countries_phone" id="id_telephone"
                                                               maxlength="75" name="phone" placeholder="电话号码"
                                                               type="text" style="width: 63%; display: inline-block;
                                                                margin-left: 2%;">
                                                    </div>
                                                    <div class="form-group">
                                                        <input class="form-control" cols="20" id="id_verify"
                                                               maxlength="6" name="verifyCode" placeholder="输入验证码"
                                                               type="text" style="width: 63%; display: inline-block;">
                                                        <button id="get_verify" type="button"
                                                                class="btn btn-default active"
                                                                style="width: 33%; display: inline-block; margin-left: 2%;">
                                                            获取验证码
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="form-actions">
                                                    <div class="text-center" style="margin-top: 10px; ">
                                                        <button class="btn btn-default" type="submit">找回密码</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <div id="invest" class="tab-pane fade">
                                            <form method="post" action="/account/password_reset_done">
                                                ${csrf_token}
                                                <div class="container-fluid">
                                                    <input class="form-control" id="id_email" maxlength="254"
                                                           name="email" placeholder="您的邮箱" type="email" name="email"
                                                           placeholder="您的邮箱" type="email" required=""
                                                           data-parsley-pattern="/^([a-zA-Z0-9]+)$/"
                                                           data-parsley-pattern-message="输入信息有误！"
                                                           data-parsley-group="block-2" data-parsley-id="9">
                                                </div>

                                                <div class="form-actions">
                                                    <div class="text-center" style="margin-top: 10px; ">
                                                        <button class="btn btn-default" type="submit">找回密码</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>

                            </div>


                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>


</div>
<#include "includes/footer.html" />
<link rel="shortcut icon" type="image/png" href="${static}/dist/meixin_invest/img/favicon.png">
<link rel="stylesheet" href="${static}/vendor/css/font-awesome.min.css">
<script src="${static}/vendor/js/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="${static}/vendor/js/jquery-ui.min.js" type="text/javascript"></script>
<script src="${static}/vendor/js/bootstrap.min.js" type="text/javascript"></script>
<script src="${static}/dist/meixin_invest/js/bootstrap-formhelpers-yellowstone.min.js" type="text/javascript"></script>
<script src="${static}/dist/meixin_invest/js/bootstrap-formhelpers-countries.zh_CN.min.js"
        type="text/javascript"></script>
<script src="${static}/dist/meixin_invest/js/bootstrap-formhelpers-phone.min.js" type="text/javascript"></script>
<script src="${static}/dist/meixin_invest/js/navi.min.js" type="text/javascript"></script>
<script>
    $(document).ready(function () {
        $('#wechat-popover').popover({
            html: true,
            placement: 'bottom',
            trigger: 'hover',
            content: '<img style="width: 200px;padding:0;margin:0;" src=""${static}/meixin_invest/img/meixin_new_qr_code_300x300.jpg" />'
        });

        //  获取手机验证码
        var first_next_step = false;
        $('#get_verify').click(function () {
            var $that = $(this);
            $(this).prop('disabled', true);
            var tel = $('#id_telephone').val();
            var country = $('#countries_phone').val();
            var timer = null, i = 60;
            timer = setInterval(function () {
                $('#get_verify').html(i + '秒后重发');
                i--;
                if (i == 0) {
                    clearInterval(timer);
                    $that.prop('disabled', false);
                    $that.html('重新发送');
                    i = 60;
                }
            }, 1000);
            if ((country != 'China' && tel.length > 6) || (country == 'China' && tel.length >= 15)) {
                $.ajax({
                    type: 'get',
                    url: '/sendVerifyCode',
                    data: {"phone": tel},
                    dataType:"json",
                    success: function (res) {
                        if (res == true) {
                            first_next_step = true;
                        }
                        if(res==false){
                            alert('');
                        }
                    }
                });
            }

            return false;
        });
        $("#general button[type=submit]").submit(function(e) {
            if ($('#general').hasClass('active')) {
                var val = $('input[name="phone"]').val();
                if (val.length<6) {
                    e.preventDefault();
                    alert("请输入手机号");
                    return false;
                }
            }
        });

        $("#invest button[type=submit]").submit(function(e) {
            if ($('#invest').hasClass('active')) {
                var val = $('input[name="email"]').val();
                if (val.indexOf('@') <= 0 ) {
                    e.preventDefault();
                    alert("请输入邮箱");
                    return false;
                }
                if (val.indexOf('@') <= 0) {
                    e.preventDefault();
                    alert("请输入正确的邮箱格式");
                    return false;
                }
            }
        })
    });
</script>
</body>
</html>