<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'/>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <title>
        美信金融|密码找回
    </title>
    <script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/js/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/js/jquery.cookie.min.js"></script>
    <script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/js/is_ok.min.js"></script>
    <link rel="stylesheet" href="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/css/bootstrap.min.css">
    <link href="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/css/base.min.css" rel="stylesheet">

    <link href="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/css/detail-new.min.css" rel="stylesheet">
    <link href="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/css/index.min.css" rel="stylesheet">
    <script type='text/javascript'>window.BWEUM||(BWEUM={});BWEUM.info =
    {"stand":true,"agentType":"browser","agent":"//bi-collector.oneapm.comhttp://dev-investor-upload.oss-cn-beijing.aliyuncs.comhttp://dev-investor-upload.oss-cn-beijing.aliyuncs.com/static/version_1.1/js/bw-send-411.4.5.js","beaconUrl":"bi-collector.oneapm.com/beacon","licenseKey":"VRQIr~Vf3JaYiJQI","applicationID":2280029};</script><script type="text/javascript" src="//bi-collector.oneapm.comhttp://dev-investor-upload.oss-cn-beijing.aliyuncs.comhttp://dev-investor-upload.oss-cn-beijing.aliyuncs.com/static/version_1.1/js/bw-loader-411.4.5.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-66578252-1', 'auto');
        ga('send', 'pageview');
    </script>
    <!--[if lt IE 9]>
    <script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/js/html5shiv"></script>
    <script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/js/respond.min.js"></script>
    <![endif]-->
    <style>
        #reset_type {
            border-bottom: 1px solid #ededed;
        }

        #reset_type li.reset_type {
            width: 50%;
            margin: 0;
        }

        .nav-pills > li > a {
            border-radius: 0;
            color: #000;
            text-align: center;
        }

        .nav-pills > li.active > a, .nav-pills > li.active > a:focus, .nav-pills > li.active > a:hover {
            background-color: #ecf7fb;
            color: #000;
        }
    </style>
    <style>
        .form-control:focus{
            border-color: #66afe9;
        }
    </style>
</head>
<body>
<div id="wrapper" class="customer">
    @@include('../includes/header.html')
    <div class="customerPage">

        <div id="customerChilantro">
            <div id="content" class="container">

                <div class="row">
                    <div class="col-xs-12">
                        <div class="row find">
                            <div class="col-xs-12 col-sm-5 col-sm-offset-4 form-box">

                                <div class="wrapper container-fluid" style="padding: 0; overflow: hidden">
                                    <h5 id="form-title" style="margin-top: 20px;">密码找回</h5>
                                    <br/>
                                    <div id="error-place" style="margin-bottom: 20px;"> </div>
                                    <ul id="reset_type" class="nav nav-pills">
                                        <li class="active reset_type"><a data-toggle="pill" href="#general">手机号</a></li>
                                        <li class="reset_type"><a data-toggle="pill" href="#invest">邮箱</a></li>
                                    </ul>

                                    <div id="remove" class="tab-content" style="padding: 40px;">
                                        <div id="general" class="tab-pane fade in active">

                                            <form method="post" action="/password_reset_confirm.html">
                                                <div class="container-fluid">
                                                    <div class="form-group">
                                                        <select id="countries_phone"
                                                                class="input-medium bfh-countries form-control"
                                                                data-country="China"
                                                                style="width: 33%;display: inline-block;" required="">
                                                        </select>
                                                        <input class="form-control bfh-phone phone-field" cols="20"
                                                               data-country="countries_phone" id="id_telephone"
                                                               maxlength="75" name="phone" placeholder="电话号码"
                                                               type="text" style="width: 63%; display: inline-block;
                                                                margin-left: 2%;">
                                                    </div>
                                                    <div class="form-group">
                                                        <input class="form-control" cols="20" id="id_verify"
                                                               maxlength="6" name="verifyCode" placeholder="输入验证码"
                                                               type="text" style="width: 63%; display: inline-block;">
                                                        <button id="get_verify" type="button"
                                                                class="btn btn-default active"
                                                                style="width: 33%; display: inline-block; margin-left: 2%;">
                                                            获取验证码
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="form-actions">
                                                    <div class="text-center" style="margin-top: 10px; ">
                                                        <button id="phone_reset" class="btn btn-default" type="submit">找回密码</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>

                                        <div id="invest" class="tab-pane fade">
                                            <form method="post" action="/password_reset_confirm.html">
                                                <div class="container-fluid">
                                                    <input class="form-control" id="id_email" maxlength="254"
                                                           name="email" placeholder="您的邮箱" type="email" name="email"
                                                           placeholder="您的邮箱" type="email" required=""
                                                           data-parsley-pattern="/^([a-zA-Z0-9]+)$/"
                                                           data-parsley-pattern-message="输入信息有误！"
                                                           data-parsley-group="block-2" data-parsley-id="9">
                                                </div>

                                                <div class="form-actions">
                                                    <div class="text-center" style="margin-top: 10px; ">
                                                        <button id="email_reset" class="btn btn-default" type="submit">找回密码</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
@@include('../includes/footer.html')
<link rel="shortcut icon" type="image/png" href="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/img/favicon.png">
<link rel="stylesheet" href="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/css/font-awesome.min.css">
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/js/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/js/jquery-ui.min.js" type="text/javascript"></script>
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/vendor/js/bootstrap.min.js" type="text/javascript"></script>
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/js/bootstrap-formhelpers-yellowstone.min.js" type="text/javascript"></script>
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/js/bootstrap-formhelpers-countries.zh_CN.min.js"
        type="text/javascript"></script>
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/js/bootstrap-formhelpers-phone.min.js" type="text/javascript"></script>
<script src="http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/js/navi.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(".form-control").on("focus",function () {
        $(".form-control").css("border-color","#D4D4E9");
    })
</script>
<script>
    $(document).ready(function () {
        $('#wechat-popover').popover({
            html: true,
            placement: 'bottom',
            trigger: 'hover',
            content: '<img style="width: 200px;padding:0;margin:0;" src=""http://bj-dev-static.oss-cn-beijing.aliyuncs.com/static/version_1.1/dist/meixin_invest/img/meixin_new_qr_code_300x300.jpg" />'
        });

        //  获取手机验证码
        var first_next_step = false;
        $('#get_verify').click(function () {
            var $that = $(this);
            $(this).prop('disabled', true);
            var tel = $('#id_telephone').val();
            var country = $('#countries_phone').val();
            var timer = null, i = 60;
            timer = setInterval(function () {
                $('#get_verify').html(i + '秒后重发');
                i--;
                if (i == 0) {
                    clearInterval(timer);
                    $that.prop('disabled', false);
                    $that.html('重新发送');
                    i = 60;
                }
            }, 1000);
            if ((country != 'China' && tel.length > 6) || (country == 'China' && tel.length >= 15)) {
                $.ajax({
                    type: 'post',
                    url: baseUrl + '/verify_code/change_pwd',
                    data: {"phone": tel},
                    dataType:"json",
                    success: function (res) {
                        if (res == true) {
                            first_next_step = true;
                        }
                        if(res==false){
                            $("#error-place").html("<div style='text-align: center;' class='alert alert-warning'>" + res.msg +"</div>");;
                        }
                    }
                });
            }
            return false;
        });

        $("#phone_reset").on('click',function() {
            if ($('#general').hasClass('active')) {
                var val = $.trim($('input[name="phone"]').val());
                var verify = $('#id_verify').val();
                console.log(val);
                if (val.length<6) {
                    $("#id_telephone").css("border-color","#ff0000");
                    return false;
                }
                if (verify.length<6){
                    $("#id_verify").css("border-color","#ff0000");
                    return false;
                }
                else {
                    window.location.href = "/email/password_reset.html?user_name= "+ val + "&verify_code=" + verify;
                }
            }
            return false;
        });

        $("#email_reset").on('click',function(e) {
            if ($('#invest').hasClass('active')) {
                var val = $('input[name="email"]').val();
                if (val.indexOf('@') <= 0 ) {
                    $("#id_email").css("border-color","#ff0000");
                    return false;
                }
                if (val.indexOf('.') <= 0) {
                    $("#id_email").css("border-color","#ff0000");
                    return false;
                }
                else{
                    var data = {};
                    data.email = $("#id_email").val();
                    $.ajax({
                        type:'post',
                        url: baseUrl + '/auth/send_reset_password_email',
                        data: data,
                        success: function (res) {
                            if (res.code == 1) {
                                $("#remove").remove();
                                $("#reset_type").remove();
                                $('#error-place').append("<p style=' text-align: center; padding: 100px 0; '>" + '密码重设邮件已发送到您的邮箱中' + "</p>");
                            } else if (res.code != 1) {
                                $("#remove").remove();
                                $("#reset_type").remove();
                                $('#error-place').append("<p style=' text-align: center; padding: 100px 0; '>" + '密码重设失败,请再次尝试' + "</p>");
                            }
                        }
                    })
                }
            }
            return false;
        })
    });
</script>
</body>
</html>